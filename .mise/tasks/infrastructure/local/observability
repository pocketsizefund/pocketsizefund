# mise description="create observability stack"
# mise tools=["terraform", "kubectl"]
# mise depends=["infrastructure:local:core"]

echo -e "${BLUE}Adding Observability Stack...${NC}"

helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
helm install prometheus prometheus-community/kube-prometheus-stack --namespace monitoring --create-namespace
helm repo add grafana https://grafana.github.io/helm-charts
helm repo update

helm install loki grafana/loki-stack --namespace monitoring

# kubectl port-forward -n monitoring service/prometheus-grafana 3000:80 &

echo -e "${BLUE}Exposing Grafana...${NC}"
echo -e "${GREEN}Grafana is now accessible at http://localhost:3000${NC}"
echo -e "${YELLOW}Default credentials: admin / prom-operator${NC}"
